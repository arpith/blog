---
layout: post
date: 2015-12-07 18:38:57 GMT
tags:
- react native
- ios
- apps
- ios app development
- history
- reading
- universal links
- navigation
- constellational
- posts
- notes
- sharing
title: "Keeping track of what youâ€™ve read"
---
<p>The <a href="http://github.com/constellational">app I&rsquo;m building</a>, <a href="http://constellational.com/">Constellational</a>, lets you <a href="https://medium.com/@arpith/sharing-a-post-520659ff3857#.a8eut0ms8">share notes</a> (<a href="http://eepurl.com/bHN6Mf">sign up here</a>!). <a href="https://github.com/constellational/iOS/compare/466ff6c6d3...5739c51667">Today I added</a> a way to easily <a href="https://github.com/constellational/iOS/issues/58">keep track of what you&rsquo;ve read</a>: the navigation page (that you can use to go to <a href="https://medium.com/@arpith/drafts-unpublished-edits-and-posts-b55fc5f1ead#.aymv4gplp">your drafts, the posts you&rsquo;re editing, or all your posts</a>) now has a list of posts you&rsquo;ve read (and users whose pages you&rsquo;ve viewed).</p><figure class="tmblr-full" data-orig-height="405" data-orig-width="540" data-orig-src="/images/18f4592060bdd757ff62ee7d34bd476ae6b948f977140574511a1ffd3c8721d2.png"><img src="/images/b5e4db15ddd5a869cb1b6d98aa1a5c4588c208b38f05c5828c28ebf623da1f37.png" data-orig-height="405" data-orig-width="540" data-orig-src="/images/18f4592060bdd757ff62ee7d34bd476ae6b948f977140574511a1ffd3c8721d2.png"></figure><p>When a <a href="https://github.com/constellational/iOS/blob/4d7ad8ea7b6036f9645a83992f7eb845a4a0a472/components/NavPage.js">row is rendered</a> on the <a href="https://medium.com/@arpith/two-steps-to-navigation-in-react-native-3f3a3cd27049#.hq4udc281">Navigation Page</a>, it first checks if it&rsquo;s a filter (like &lsquo;All Posts&rsquo; or &lsquo;Drafts&rsquo;) and creates an appropriate onPress function (pushing the filter onto the navigator as part of the route).</p><pre>renderRow(row) {<br> &nbsp;if (typeof row === 'string') {<br> &nbsp; &nbsp;var onPress = () =&gt; {<br> &nbsp; &nbsp; &nbsp;this.props.navigator.push({id: 'posts', filter: row});<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;return &lt;View style={styles.option}&gt;<br> &nbsp; &nbsp; &nbsp;&lt;Text onPress={onPress} style={styles.text}&gt;{row}&lt;/Text&gt;<br> &nbsp; &nbsp;&lt;/View&gt;;<br> &nbsp;} else {<br> &nbsp; &nbsp;var onPress = () =&gt; {<br> &nbsp; &nbsp; &nbsp;this.props.navigator.push({<br> &nbsp; &nbsp; &nbsp; &nbsp;username: row.username,<br> &nbsp; &nbsp; &nbsp; &nbsp;postURL: row.url<br> &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;var text = row.username;<br> &nbsp; &nbsp;if (row.url) text = row.data.split('\n')[0];<br> &nbsp; &nbsp;return &lt;View style={styles.option}&gt;<br> &nbsp; &nbsp; &nbsp;&lt;Text onPress={onPress} style={styles.text}&gt;{text}&lt;/Text&gt;<br> &nbsp; &nbsp;&lt;/View&gt;;<br> &nbsp;}<br>}</pre><p>If the row is a history object, it will either have a postURL for the post you read, or just a username for the user page you visited. If it&rsquo;s a post, row.data.split(&lsquo;\n&rsquo;)[0] lets us display just the first line.</p><p>This means we can start working on <a href="https://github.com/constellational/iOS/issues/51">reading other users pages or posts in the app</a> (instead of just <a href="https://medium.com/@arpith/displaying-your-webpage-4dd545fc92f9#.3j47dreth">in the browser</a>). The code we&rsquo;re interested in (in getAll(), in <a href="https://medium.com/@arpith/reading-everyone-you-love-cccf3d7c2f1e#.wgz4gq6m0">the Posts Page</a>) is:</p><pre>getAll() {<br> &nbsp;if (this.props.username) {<br> &nbsp; &nbsp;var user = PostStore.getUser(this.props.username);<br> &nbsp; &nbsp;if (this.props.postID) {<br> &nbsp; &nbsp; &nbsp;// Find the postURL that contains the postID<br> &nbsp; &nbsp; &nbsp;var postURL = user.posts[0];<br> &nbsp; &nbsp; &nbsp;user.posts.forEach((url) =&gt; {<br> &nbsp; &nbsp; &nbsp; &nbsp;if (url.indexOf(this.props.postID) &gt; -1) postURL = url;<br> &nbsp; &nbsp; &nbsp;});<br> &nbsp; &nbsp; &nbsp;// Move it to be displayed on top<br> &nbsp; &nbsp; &nbsp;user.posts.splice(user.posts.indexOf(postURL), 1);<br> &nbsp; &nbsp; &nbsp;user.posts.unshift(postURL);<br> &nbsp; &nbsp;} <br> &nbsp; &nbsp;var posts = user.posts.map((url) =&gt; {<br> &nbsp; &nbsp; &nbsp;PostStore.getPost(this.props.username, url));<br> &nbsp; &nbsp;}<br> &nbsp; &nbsp;return posts;<br> &nbsp;}<br>}</pre><p>That is, we first get the user&rsquo;s list of posts, and if we&rsquo;ve got a post we&rsquo;re especially interested in, we move it to the top when we render the posts.</p><p>Note that today&rsquo;s work fixes <a href="https://github.com/constellational/iOS/issues/58">#58</a>. Still to come: <a href="https://github.com/constellational/iOS/issues/51">opening links that look like constellational.com/username/postID</a>. This brings us closer to <a href="https://github.com/constellational/iOS/issues/28">universal links</a>.</p>